# AIsCopy PRD (Product Requirements Document)

## 1. 프로젝트 개요

### 1.1 프로젝트명
**AIsCopy** - 실시간 화면 번역 도구

### 1.2 프로젝트 목적
사용자가 지정한 화면 영역을 실시간으로 캡처하여 AI 기반 번역을 수행하고, 결과를 별도 창에 표시하는 데스크톱 애플리케이션

### 1.3 타겟 사용자
- 다국어 콘텐츠를 자주 번역해야 하는 사용자
- 실시간 번역이 필요한 업무 환경의 사용자
- 화면 캡처 기반 번역 도구를 필요로 하는 사용자

## 2. 핵심 기능 요구사항

### 2.1 화면 제어 및 UI

#### 2.1.1 오버레이 창 시스템
- **첫 실행**: 설정 파일이 없을 때만 설정 화면 표시
- **일반 실행**: 설정이 저장된 경우 간단한 시작 창 표시
- **기본 창 구성**: 시작 후 2개의 오버레이 창 자동 생성
  - 번역 대상 창 (Source Window)
  - 번역 출력 창 (Output Window)
- **창 스타일**: 탐색기 창과 유사한 디자인
- **위치 관리**: 사용자가 자유롭게 위치 및 크기 조절 가능
- **항상 위에 표시**: 다른 애플리케이션 위에 항상 표시

#### 2.1.2 창 상호작용
- **번역 대상 창**:
  - 완전 투명 (투명도 100%)
  - 테두리만 표시하여 영역 구분
  - 마우스로 이동 및 크기 조절 가능
- **번역 출력 창**:
  - 일반 모드: 반투명 배경 (사용자 설정 가능, 기본값: 80%)
  - 클릭-스루 모드: 동일한 투명도 유지 (마우스 이벤트만 무시)
  - 마우스 이벤트 무시 (클릭-스루)
  - 배경 애플리케이션과 상호작용 가능

#### 2.1.3 창 조절 기능
- **이동**: 제목 표시줄 드래그로 위치 변경
- **크기 조절**: 창 모서리/가장자리 드래그로 크기 변경
- **최소화**: 우클릭 메뉴 또는 단축키로 최소화
- **설정 저장**: 창 위치/크기 정보 자동 저장 및 복원

### 2.2 번역 프로세스

#### 2.2.1 화면 캡처
- **주기적 캡처**: 사용자 설정 간격(1초, 3초, 5초)마다 번역 대상 영역 캡처
- **고성능 캡처**: mss 라이브러리 사용으로 다중 모니터 환경 지원
- **영역 기반**: 저장된 좌표와 크기만큼만 정확히 캡처

#### 2.2.2 변화 감지 (API 호출 최적화)
- **이미지 비교**: OpenCV 또는 Pillow를 사용한 구조적 유사성 지수(SSIM) 계산
- **임계값 설정**: 사용자가 설정 가능한 변화 감지 민감도
- **비용 절약**: 변화가 없을 때 불필요한 API 호출 방지

#### 2.2.3 AI 번역
- **API 연동**: Google Gemini API 사용 (gemini-2.5-flash, gemini-2.5-flash-lite)
- **모델 선택**: 사용자가 속도/품질에 따라 모델 선택 가능
- **통합 처리**: 이미지에서 텍스트 인식과 번역을 한 번에 처리
- **결과 표시**: 번역된 텍스트를 출력 창에 실시간 표시

### 2.3 상호작용 및 편의 기능

#### 2.3.1 단축키 시스템
- **클릭-스루 모드 토글**: `Ctrl+T` (기본값)
- **번역 실행**: `Ctrl+Shift+T` (수동 번역 - API 호출량 절약)
- **설정 열기**: `Ctrl+,`
- **앱 종료**: `Ctrl+Q`
- **단축키 커스터마이징**: 사용자가 원하는 키 조합으로 변경 가능

#### 2.3.2 사용자 설정
- **API 키 설정**: Google Gemini API 키 입력 및 저장
- **번역 언어**: 목표 언어 선택 (한국어, 영어, 일본어, 중국어 등)
- **캡처 간격**: 1초, 3초, 5초, 10초, 수동 모드
- **번역 모델**: gemini-2.5-flash (빠름) vs gemini-2.5-flash-lite (더 빠름) 선택
- **출력 창 투명도**: 배경 투명도 조절 (모든 모드에서 동일)
- **API 호출 모드**: 자동 모드 vs 수동 모드 (단축키로만 번역 실행)

## 3. 기술 요구사항

### 3.1 기술 스택
- **언어**: Python 3.12+ (최신 안정 버전)
- **GUI**: PySide6 (Qt6 기반, 상업적 사용 가능)
- **화면 캡처**: mss (고성능, 다중 모니터 지원)
- **이미지 처리**: OpenCV-Python, Pillow
- **단축키**: pynput (전역 단축키 지원)
- **AI API**: Google Gemini API (google-generativeai 패키지)
  - gemini-2.5-flash (빠름)
  - gemini-2.5-flash-lite (더 빠름)
- **비동기 처리**: asyncio, aiohttp
- **설정 관리**: configparser, json
- **암호화**: cryptography (API 키 보안)

### 3.2 성능 요구사항
- **메모리 사용량**: 100MB 이하
- **CPU 사용률**: 평균 5% 이하
- **응답 시간**: 번역 요청 후 3초 이내 결과 표시
- **안정성**: 24시간 연속 실행 가능

### 3.3 플랫폼 지원
- **Windows**: 10/11 (64비트)
- **macOS**: 12.0+ (Intel/Apple Silicon)
- **Linux**: Ubuntu 20.04+ (선택적)

### 3.4 의존성 패키지
```txt
# requirements.txt
PySide6>=6.6.0
mss>=9.0.1
opencv-python>=4.9.0
Pillow>=10.2.0
pynput>=1.7.6
google-generativeai>=0.4.0
aiohttp>=3.9.0
cryptography>=42.0.0
numpy>=1.26.0
```

## 4. 사용자 인터페이스 설계

### 4.1 창 디자인

#### 4.1.1 번역 대상 창
```
┌─────────────────────────┐
│  번역 대상 [⚙][−][×]    │  ← 제목 표시줄
├─────────────────────────┤
│                         │
│    [영역 표시 프레임]     │  ← 완전 투명 (테두리만 표시)
│                         │
│                         │
└─────────────────────────┘
```

#### 4.1.2 번역 출력 창
```
┌─────────────────────────┐
│  번역 출력 [⚙][−][×]    │  ← 제목 표시줄
├─────────────────────────┤
│                         │
│    [번역 결과 텍스트]     │  ← 반투명 배경 (사용자 설정 가능)
│                         │
│                         │
└─────────────────────────┘
```

### 4.2 앱 시작 UI 구성

#### 4.2.1 첫 실행 시 (설정 파일 없음)
```
┌─────────────────────────────────────────┐
│  AIsCopy 초기 설정                      │
├─────────────────────────────────────────┤
│                                         │
│  Google Gemini API 설정                 │
│  ┌─────────────────────────────────┐   │
│  │ API 키: [________________] [테스트] │   │
│  └─────────────────────────────────┘   │
│                                         │
│  번역 설정                              │
│  목표 언어: [한국어 ▼]                   │
│  모델: ○ gemini-2.5-flash              │
│        ○ gemini-2.5-flash-lite         │
│  캡처 간격: [3초 ▼]                     │
│                                         │
│  창 설정                                │
│  출력창 투명도: [████████░░] 80%        │
│  API 호출 모드: ○ 자동  ○ 수동          │
│                                         │
│  단축키 설정                            │
│  클릭-스루 토글: [Ctrl+T] [변경]        │
│  번역 실행: [Ctrl+Shift+T] [변경]       │
│  설정 열기: [Ctrl+,] [변경]             │
│                                         │
│  [완료] [취소]                          │
└─────────────────────────────────────────┘
```

#### 4.2.2 일반 실행 시 (설정 파일 있음)
```
┌─────────────────────────────────────────┐
│  AIsCopy                                │
├─────────────────────────────────────────┤
│                                         │
│  번역 도구가 준비되었습니다              │
│                                         │
│  현재 설정:                             │
│  • 목표 언어: 한국어                    │
│  • 모델: gemini-2.5-flash              │
│  • 호출 모드: 수동                      │
│                                         │
│  [시작하기] [설정] [종료]               │
└─────────────────────────────────────────┘
```

#### 4.2.3 설정 화면 (설정 버튼 클릭 시)
- **탭 구성**: API, 번역, 창, 단축키 설정으로 분류
- **실시간 미리보기**: 설정 변경 시 즉시 적용 및 미리보기
- **저장 방식**: JSON 파일과 UI 동기화

#### 4.2.4 메뉴 시스템
- **우클릭 메뉴**: 모드 전환, 설정, 최소화, 종료
- **상태 표시**: 현재 모드, 번역 상태, API 연결 상태

## 5. 데이터 관리

### 5.1 설정 파일
```json
{
  "api": {
    "gemini_api_key": "your_api_key_here"
  },
  "windows": {
    "source": {
      "x": 100, "y": 100,
      "width": 300, "height": 200,
      "visible": true
    },
    "output": {
      "x": 450, "y": 100,
      "width": 300, "height": 200,
      "visible": true
    }
  },
  "translation": {
    "target_language": "ko",
    "capture_interval": 3,
    "model": "gemini-2.5-flash"
  },
  "ui": {
    "click_through_mode": false,
    "output_window_opacity": 0.8,
    "api_call_mode": "manual"
  },
  "hotkeys": {
    "toggle_click_through": "Ctrl+T",
    "manual_translate": "Ctrl+Shift+T",
    "open_settings": "Ctrl+,"
  }
}
```

### 5.2 로그 관리
- **번역 로그**: 번역 요청/응답 기록
- **에러 로그**: 오류 발생 시 상세 정보 기록
- **성능 로그**: API 응답 시간, 메모리 사용량 등

## 6. 에러 처리 및 예외 상황

### 6.1 API 관련
- **연결 실패**: 재시도 로직 (최대 3회)
- **API 한도 초과**: 사용자에게 알림 및 대기
- **잘못된 응답**: 기본 오류 메시지 표시

### 6.2 시스템 관련
- **메모리 부족**: 이미지 캐시 정리
- **화면 캡처 실패**: 오류 메시지 및 재시도
- **설정 파일 손상**: 기본값으로 복구

## 7. 보안 및 개인정보 보호

### 7.1 데이터 보호
- **API 키**: 사용자가 직접 입력하여 설정 파일에 암호화 저장
- **화면 캡처**: 로컬에서만 처리, 외부 전송 없음
- **번역 데이터**: API 전송 후 즉시 삭제
- **API 키 보안**: 설정 파일 암호화 및 안전한 저장

### 7.2 사용자 동의
- **화면 캡처 권한**: 앱 실행 시 권한 요청
- **개인정보 처리**: 개인정보 처리방침 제공

## 8. 성공 지표

### 8.1 기능적 지표
- 번역 정확도: 90% 이상
- API 호출 최적화: 불필요한 호출 80% 감소
- 사용자 만족도: 4.0/5.0 이상

### 8.2 기술적 지표
- 앱 시작 시간: 3초 이내
- 번역 응답 시간: 3초 이내
- 메모리 사용량: 100MB 이하
- CPU 사용률: 평균 5% 이하

## 9. 부록

### 9.1 용어 정의
- **오버레이 창**: 다른 애플리케이션 위에 표시되는 반투명 창
- **클릭-스루**: 마우스 이벤트를 무시하고 배경으로 전달하는 기능
- **SSIM**: 구조적 유사성 지수, 이미지 품질 측정 방법
- **Gemini API**: Google의 통합 AI API (이미지 인식 + 번역)

### 9.2 참고 자료
- PyQt6 공식 문서
- Google Gemini API 문서
- OpenCV Python 튜토리얼
- mss 라이브러리 가이드

---

**문서 버전**: 1.0  
**작성일**: 2025년 9월  
**작성자**: AIsCopy 개발팀
